<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Iniciando com dados</title>
    <meta charset="utf-8" />
    <meta name="author" content="Daniel Marcelino   Brasília" />
    <meta name="date" content="2021-09-26" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/shareon/shareon.min.css" rel="stylesheet" />
    <script src="libs/shareon/shareon.min.js"></script>
    <link href="libs/xaringanExtra-shareagain/shareagain.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-shareagain/shareagain.js"></script>
    <link href="libs/countdown/countdown.css" rel="stylesheet" />
    <script src="libs/countdown/countdown.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Iniciando com dados
## Scrapping e manipulação de dados em R <br> Confederação Nacional da Indústria - CNI
### Daniel Marcelino <br> Brasília
### 2021-09-26

---









## Vimos na última aula...

+ nós vimos como configurar um projeto e sua estrutura de arquivos 

+ vimos como iniciar o uso do R dentro do RStudio

+ também vimos exemplos de como criar vetores numéricos, characters e lógicos`c()` 

+ aprendemos também os primeiros passor para filtrar e obter subconjuntos de vetores usando os colchetes `[]` e outras funcões: `length()`, `:`, `seq(from, to, interval)`

+ subconjuntos de vetores podem ser obtidos via teste númerico ou índices lógicos (`TRUE`/`FALSE`)


---
## Estrutura de dados 

+ __vector__: matrizes lineares (uma dimensão: apenas comprimento) 

--

+ __factors__: vectores (uma dimensão) representando __variáveis categóricas__ e portanto tendo __níveis (levels)__

--

+ __matrices__: matrizes de vetores -&gt; de um mesmo tipo (todos numéricos ou todos character, strings (texto), por exemplo) (duas dimensões: largura e comprimento)

--

+ __data frames__: arrays ou matrizes bidimensionais, mas podem ser de tipos combinados (como: coluna 1 com nomes ou rótulos, coluna 2 com números). Podemos acessar uma coluna em particular a partir do operador `$`, e a um valor individual no data frame usando a notação `[linha,coluna]`.

--

+ __arrays__ são similares a matrizes e data frames, mas podem ser objetos tridimensionais, data frame em camadas ("layered" data frames)

--

+ __list__: literalmente uma lista de qualquer coisa (uma lista de data frames, ou diferentes objetos)


???

_As variáveis categóricas contêm um número finito de categorias ou grupos distintos. Os dados categóricos podem não ter uma ordem lógica. Por exemplo, os preditores categóricos incluem gênero, tipo de material e método de pagamento._

_As cariáveis discretas são variáveis numéricas que têm um número contável de valores entre quaisquer dois valores. Uma variável discreta é sempre numérica. Por exemplo, o número de reclamações de clientes ou o número de falhas ou defeitos._

_As variáveis contínuas são variáveis numéricas que têm um número infinito de valores entre dois valores quaisquer. Uma variável contínua pode ser numérica ou de data/hora. Por exemplo, o comprimento de uma peça ou a data e hora em que um pagamento é recebido._


---
## Matrizes

+ dados precisam ser do mesmo tipo


```r
?matrix
matrix(nrow = 4, ncol = 3)
```

```
##      [,1] [,2] [,3]
## [1,]   NA   NA   NA
## [2,]   NA   NA   NA
## [3,]   NA   NA   NA
## [4,]   NA   NA   NA
```

---
## Matrizes

+ você pode também ajustar vetores com as __dimensões corretas__ 


```r
nums &lt;- 1:12
matrix(data = nums, nrow = 3)
matrix(data = nums, nrow = 3, byrow = TRUE)
```


---
## Matrizes 


```r
dim1_nomes &lt;- c("r1", "r2", "r3")
dim2_nomes &lt;- c("c1", "c2", "c3", "c4")
nomes_matrix &lt;- list(dim_1 = dim1_nomes, dim_2 = dim2_nomes)
str(nomes_matrix)
m &lt;- matrix(data = nums, nrow = 3,
       dimnames = nomes_matrix)
dim(m)
dimnames(m)
```

--

+ você pode converter facilmente entre os mais variados tipos de dados  `data.frame("m")`, `as.data.frame("m")`, `as.vector(m)`.
(o mesmo se aplica para alterações entre "numeric" e "logical")


---
class: inverse, middle, center
# Iniciando com data frames 

---

## Dataset de proposições da Câmara dos Deputados

+ data frames: uma linha por proposição legislativa (não única), um coluna por variável

&lt;img src="https://raw.githubusercontent.com/dmarcelinobr/curso_r-cni/main/slides/figs/proposicoes_dataset.png" width="740" style="display: block; margin: auto;" /&gt;



---
class:middle, inverse, center

## Pausa, respirem, levantem as dúvidas

<div class="countdown" id="timer_6150caf7" style="top:0;right:30%;margin:5%;padding:10px;font-size:5em;" data-warnwhen="0">
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>




---
## Fazendo download de tabelas estruturadas

Vamos baixar uma tabela de dados diretamente na seguinte subpasta `./dados/brutos`:



&lt;small&gt;

```r
raiz = "https://dadosabertos.camara.leg.br/"
caminho = "arquivos/proposicoesAutores/"
tipo = "csv/"
arquivo = "proposicoesAutores-2020.csv"

url = paste(raiz, caminho, tipo, arquivo, sep="")

download.file(url = url, 
              destfile = "../dados/brutos/proposicoesAutores-2020.csv")
```


--



```
## [1] "https://dadosabertos.camara.leg.br/arquivos/proposicoesAutores/csv/proposicoesAutores-2020.csv"
```


---
## Lendo arquivo de dados no R

Funcões para ler os dados são importantes para qualquer projeto.
Para data frames: `read.csv()`, `read.delim()`, `read.table()`



```r
proposicoes &lt;- read.csv2("../dados/brutos/proposicoesAutores-2020.csv")

proposicoes2 &lt;- read.delim(file =
                          "../dados/brutos/proposicoesAutores-2020.csv",
                            sep = ";",
                            header = TRUE)

identical(proposicoes, proposicoes2)
```

```
## [1] TRUE
```

```r
# remover arquivo da mémoria
rm(proposicoes2)
```



---
## Lendo arquivo de dados no R

+ Pacote __readr__ 
+ Pacote __data.table__ (`data.table::fread()`) geralmente quando vocês precisa abrir um arquivo com volume maior de dados 
+ Planilhas do Excel: `readxl::read_excel()`
+ __Interface Gráfica__

Existem __muitas outras maneiras__ de ler dados no R, algumas são específicas para o tipo de dados (GIS shapefiles ou raster, e pacotes específicos podem vir com suas próprias funções de leitura)

---
## Examinando objetos do tipo `data.frame`


```r
str(proposicoes)
dim(proposicoes)
nrow(proposicoes)
ncol(proposicoes)
head(proposicoes) # 6 linhas por padrão
tail(proposicoes)
names(proposicoes)
rownames(proposicoes)
length(proposicoes) # numero de colunas
summary(proposicoes)
```

---
## Examinando objetos do tipo `data.frame`

Baseado no resultado de `str(proposicoes)`, você conseguiria responder as perguntas a seguir?

+ Qual é a classe do objeto proposicoes?

+ Quantas linhas e quantas colunas há nesse objeto?

+ Qual é o tipo de dados nessas colunas?


---
## Indexando e obtendo subconjuntos de data frames

+ um vetor tem apenas uma dimensão, então:

  + `length()` refere-se ao número de __elementos__
  + `dim()`
  + seleção entre colchetes `[]`

--

+ um data frame por outro lado tem __duas__ dimensões: `dim()`, `ncol()`, `nrow()` seleção entre colchetes `[]` __MAS com as duas dimensões separadas por uma vírgula__: `[linhas, colunas]`

--

+ vamos tentar nos refeir a essas operações como __selecionar colunas__ e __filtrar linhas__

---
## Selecionando colunas

+ com índices numéricos e vetores 


```r
proposicoes[, 8]
proposicoes[1, ]
proposicoes[ , 12]
proposicoes[4, 12]
proposicoes[1:4, 1:3]
```

---
## Indexando e obtendo subconjuntos de data frames

+ o sinal de menos indica __remover__ o índice de uma coluna ou linha, ou seja, remover aquela coluna ou linha


```r
# Todo o data frame, exceto a primeira coluna
proposicoes[, -1]
nrow(proposicoes)
proposicoes[-(7:55540), ] # Equivalente ao comando head(proposicoes)
```


---
## Selecionando colunas pelo nome 


```r
names(proposicoes)

  proposicoes["nomeAutor"]     # Resultado é também um data frame
* proposicoes[["nomeAutor"]]   # Resultado é um vetor
* proposicoes[, "nomeAutor"]   # Resultado é um vetor
* proposicoes$nomeAutor        # Resultado é um vetor
```


+ R tem muitas maneiras de fazer a mesma coisa

---
## Indexando e obtendo subconjuntos de data frames

&lt;small&gt;

```r
sub &lt;- proposicoes[1:10,]
# primeiro elemento na primeira coluna do data frame

# primeiro elemento na 8a coluna

# primeira coluna do data frame (como um vetor)

# primeira coluna do data frame (como um data frame)

# primeiros três elementos da  6a coluna (como um vetor)

# a 3a linha do data frame

# equivalente ao head_proposicoes &lt;- head(proposicoes)
```


---
## Indexando e obtendo subconjuntos de data frames

&lt;small&gt;

```r
sub &lt;- proposicoes[1:10,]
# primeiro elemento na primeira coluna do data frame
sub[1, 1]
# primeiro elemento na 8a coluna
sub[1, 8]
# primeira coluna do data frame (como um vetor)
sub[, 1]
# primeira coluna do data frame (como um data frame)
sub[1]
# primeiros três elementos da  6a coluna (como um vetor)
sub[1:3, 6]
# a 3a linha do data frame
sub[3, ]
# equivalente ao head_proposicoes &lt;- head(proposicoes)
head_proposicoes &lt;- proposicoes[1:6, ]
```


---
## Desafio

&lt;small&gt;

+ Crie um data frame (`proposicoes_500`) contendo apenas os dados da linha 500 da tabela `proposicoes`

--

+ Observe como a função `nrow()` retorna pra você o número de linhas no data frame. Use esse número para obter apenas o último registro, a última linha do data frame `proposicoes`

--

+ Compare este resultado com o que você vê no último registro usando a função `tail()` para ter certeza

--

+ Retire a última linha usando `nrow ()` ao invés do número da linha.

--

+ Crie um data frame (`proposicoes_ultima`) a partir da última linha.

--

+ Use `nrow ()` para extrair a linha que está no meio do data frame. Armazene o conteúdo desta linha em um objeto chamado `proposicoes_meio`.


&lt;/small&gt;




---
## Lidando com dados ausentes ou perdidos


```r
sub &lt;- proposicoes[1:10,]
# str(sub)
sub$siglaPartidoAutor
sub$siglaPartidoAutor == NA # o R não pode comparar porque existe NA 

# nós usamos então a função is.na: 
# is.na(sub$siglaPartidoAutor) # agora sim vai retornar um vetor lógico 
sub$nomeAutor[ !is.na(sub$siglaPartidoAutor) ]
```

--

+ em algumas funções vamos ter que usar: `na.rm`


---
## Lidando com dados ausentes ou perdidos
  
  + Lidando com dados ausentes em data frames: __filtrando linhas que têm NAs__


```r
sem_NA_id &lt;- proposicoes[!is.na(proposicoes$idDeputadoAutor),]
dim(sem_NA_id)
```

```
## [1] 52311    12
```

```r
sem_NA &lt;- proposicoes[!is.na(proposicoes$idDeputadoAutor) &amp;
                        !is.na(proposicoes$siglaPartidoAutor),]
dim(sem_NA)
```

```
## [1] 52311    12
```


---
## Lidando NA
  

```r
# complete.cases(proposicoes)
proposicoes1 &lt;- proposicoes[complete.cases(proposicoes) , ]
proposicoes2 &lt;- na.omit(proposicoes)
dim(proposicoes1)
```

```
## [1] 52311    12
```

```r
dim(proposicoes2)
```

```
## [1] 52311    12
```



---
## Gravando o data frame processado no disco (no lugar certo)


```r
if(!dir.exists("../dados/processados"))
  dir.create("../dados/processados", recursive = T)

write.csv2(proposicoes1, 
           file = "../dados/processados/proposicoes_mod.csv",
           row.names = FALSE)
```


#### Lembre-se de nunca reescrever seu arquivo bruto de dados 

---
# Carrega o csv modificado


```r
props &lt;- read.delim("../dados/processados/proposicoes_mod.csv", sep = ";")

str(props)
```



---
class: inverse, middle, center

# Ciclos no R com laços for, if e while

---

## Os ciclos são implementados com os operadores for e while


```r
for (i in 1:3)
  {
  y = i+1
  print(y)
}
```

```
## [1] 2
## [1] 3
## [1] 4
```


---
## Os ciclos são implementados com os operadores for e while


```r
i &lt;- 1
while(i &lt;= 3)
  {
  y = i+1
  print(y)
  i = i+1
}
```

```
## [1] 2
## [1] 3
## [1] 4
```

---

## Condições if 

A estrutura para definião de condições no R é a seguinte:
`if(condição){afirmação 1} else {afirmação 2}`


```r
x &lt;- 5
if(x &gt; 0){
  print("x é positivo")
} else{
  print("x é negativo")
}
```

```
## [1] "x é positivo"
```


---

# Condições if 

```r
if(proposicoes$proponente[10] &gt; 0){
  TRUE
} else {
  FALSE
}
```

```
## [1] TRUE
```



---
class: center, middle
# Obrigado!

&lt;center&gt;
&lt;svg viewBox="0 0 512 512" style="position:relative;display:inline-block;top:.1em;fill:#A70000;height:1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"&gt;&lt;/path&gt;&lt;/svg&gt; [dmarcelino@live.com](mailto:dmarcelino@live.com) 

&lt;svg viewBox="0 0 512 512" style="position:relative;display:inline-block;top:.1em;fill:#A70000;height:1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"&gt;&lt;/path&gt;&lt;/svg&gt; [@dmarcelinobr](https://twitter.com/dmarcelinobr) 

&lt;svg viewBox="0 0 448 512" style="position:relative;display:inline-block;top:.1em;fill:#A70000;height:1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"&gt;&lt;/path&gt;&lt;/svg&gt;
[dmarcelinobr](https://www.linkedin.com/in/dmarcelinobr/) 

&lt;svg viewBox="0 0 496 512" style="position:relative;display:inline-block;top:.1em;fill:#A70000;height:1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"&gt;&lt;/path&gt;&lt;/svg&gt;
[dmarcelinobr](http://github.com/dmarcelinobr) 
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": true,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
